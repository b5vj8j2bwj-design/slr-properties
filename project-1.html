<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Palm Desert – San Luis Rey | Construction Progress | SLR Properties</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Cache-buster so GitHub Pages loads new styles -->
  <link rel="stylesheet" href="style.css?v=20" />
</head>

<body>

<!-- HEADER -->
<header class="topbar">
  <div class="wrap topbar-inner">
    <a class="brand" href="index.html">
      <img src="images/logo.png" alt="SLR Property" class="logo">
    </a>
    <nav class="nav">
      <a href="index.html">Home</a>
      <a href="about.html">About</a>
    </nav>
  </div>
</header>

<!-- MAIN -->
<main class="wrap">

  <!-- PAGE TITLE -->
  <section class="pagehead">
    <h1>Palm Desert – San Luis Rey</h1>
    <p class="subhead">Before / After comparison and construction progress</p>
  </section>

  <!-- BEFORE / AFTER SLIDER -->
  <section class="section">
    <div class="section-title">
      <h2>Before & After</h2>
      <p>Drag the slider to compare. Final photo will be updated when complete.</p>
    </div>

    <div class="ba-slider">
      <img class="ba-img" src="images/before.jpg" alt="Before renovation">

      <div class="ba-after">
        <img class="ba-img" src="images/after.jpg" alt="After renovation (placeholder)">
      </div>

      <input type="range" min="0" max="100" value="50" class="ba-range">
    </div>
  </section>

  <!-- CONSTRUCTION PROGRESS -->
  <section class="section">
    <div class="section-title">
      <h2>Construction Progress</h2>
      <p>Ongoing documentation throughout the renovation.</p>
    </div>

    <div class="gallery" id="progressGallery"></div>
  </section>

  <section class="section">
    <a class="backlink" href="index.html">← Back to projects</a>
  </section>

</main>

<!-- FOOTER -->
<footer class="footer">
  <div class="wrap">
    <p>© <span id="year"></span> SLR Properties · Coachella Valley</p>
  </div>
</footer>

<!-- LIGHTBOX -->
<div class="lightbox" id="lightbox">
  <button class="lb-close">✕</button>
  <button class="lb-prev">‹</button>
  <img id="lightboxImg" alt="Expanded photo">
  <button class="lb-next">›</button>
</div>

<script>
/* ===============================
   FOOTER YEAR
=============================== */
document.getElementById("year").textContent = new Date().getFullYear();

/* ===============================
   BEFORE / AFTER SLIDER
=============================== */
const slider = document.querySelector(".ba-range");
const after = document.querySelector(".ba-after");

slider.addEventListener("input", e => {
  after.style.width = e.target.value + "%";
});

/* ===============================
   PROGRESS GALLERY
=============================== */
const PROGRESS_COUNT = 45; // ← change when you add photos
const gallery = document.getElementById("progressGallery");

function pad(n){ return String(n).padStart(2, "0"); }

for(let i = 1; i <= PROGRESS_COUNT; i++){
  const img = document.createElement("img");
  img.src = `images/progress/${pad(i)}.jpg`;
  img.alt = `Construction progress ${i}`;
  img.loading = "lazy";
  gallery.appendChild(img);
}

/* ===============================
   LIGHTBOX
=============================== */
const lb = document.getElementById("lightbox");
const lbImg = document.getElementById("lightboxImg");
const imgs = Array.from(gallery.querySelectorAll("img"));
let index = 0;

imgs.forEach((img, i) => {
  img.addEventListener("click", () => {
    index = i;
    lbImg.src = img.src;
    lb.classList.add("open");
  });
});

document.querySelector(".lb-close").onclick = () => lb.classList.remove("open");
document.querySelector(".lb-prev").onclick = () => {
  index = (index - 1 + imgs.length) % imgs.length;
  lbImg.src = imgs[index].src;
};
document.querySelector(".lb-next").onclick = () => {
  index = (index + 1) % imgs.length;
  lbImg.src = imgs[index].src;
};

lb.addEventListener("click", e => {
  if(e.target === lb) lb.classList.remove("open");
});

document.addEventListener("keydown", e => {
  if(!lb.classList.contains("open")) return;
  if(e.key === "Escape") lb.classList.remove("open");
  if(e.key === "ArrowLeft") document.querySelector(".lb-prev").click();
  if(e.key === "ArrowRight") document.querySelector(".lb-next").click();
});
</script>

</body>
</html>
